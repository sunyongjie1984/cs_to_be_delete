
var refer=document.referrer;
var referHost = getHost(refer);
var referStr = getHostStr(referHost);
if (referStr != "和讯")
{
    document.write("<div id='popBoxDiv' style='background-color:Transparent;overflow:hidden;position:fixed;right:0;bottom:0;width:320px;height:0;font-family:宋体;font-size:12px;_position:absolute;_top:expression(documentElement.scrollTop + (documentElement.clientHeight-this.clientHeight) - 1);'>");
    document.write("<div style='width:320px;height:27px;line-height:27px;background:url(http://img.hexun.com/2009/blog/pop101.gif);text-align:right'>");
    document.write("<div style='float:left;color:#fff;font-weight:bold;padding-left:5px;line-height:26px;height:26px;'>欢迎" + getFromStr(referStr) + "来到&nbsp;<span style='font-size:14px'>和讯博客</span></div>");
    document.write("<div style='float:right;padding-top:2px;'><a href='javascript:closePopBox();' title='关闭'><img src='http://img.hexun.com/2009/blog/close.gif' border=0 alt='关闭' /></a>&nbsp;</div>");
    document.write("</div>");
    document.write("<iframe src='" + getIframeSrc(referStr) + "' scrolling=no frameborder=0 width=320 height=205 allowTransparency=true></iframe>");
    document.write("</div>");
}
showPopBox(); 
//setTimeout("closePopBox()",5000); 

function showPopBox()
{
    var box=document.getElementById("popBoxDiv"); 
    if (box)
    { 
        if (box.clientHeight < 200)
            box.style.height=box.clientHeight+25+"px";
        else
            box.style.height=box.clientHeight+5+"px";
        if (box.clientHeight<205) setTimeout(function(){showPopBox()},5);
    }
}

function closePopBox()
{ 
    if (document.getElementById("popBoxDiv"))
        document.getElementById("popBoxDiv").style.display="none"; 
}

function getHost(url) 
{
    var host = "";
    if(typeof(url) == "undefined" || url == null || url == "")
    { 
        return "";
    }
    else
    {
        var regex = /.*\:\/\/([^\/]*).*/; 
        var match = url.match(regex); 
        if(typeof(match)!= "undefined" && null != match)
        {
            host = match[1];
        }
        return host.toLowerCase();
    }
}

function getHostStr(host)
{
    if(typeof(host) == "undefined" || host == null || host == "")
        return "和讯";
    if (host.indexOf("hexun") >= 0)
        return "和讯";
    if (host.indexOf("blogsearch.google.cn") >= 0)
        return "google博客搜索";
    if (host.indexOf("google.cn") >= 0)
        return "google搜索";
    if (host.indexOf("google.com") >= 0)
        return "google搜索";
    if (host.indexOf("blogsearch.baidu.com") >= 0)
        return "百度博客搜索";
    if (host.indexOf("tieba.baidu.com") >= 0)
        return "百度贴吧";
    if (host.indexOf("hi.baidu.com") >= 0)
        return "百度空间";
    if (host.indexOf("zhidao.baidu.com") >= 0)
        return "百度知道";
    if (host.indexOf("baidu.com") >= 0)
        return "百度搜索";
    if (host.indexOf("soso.com") >= 0)
        return "腾讯搜搜";
    if (host.indexOf("sogou.com") >= 0)
        return "搜狗搜索";
    if (host.indexOf("alimama.com") >= 0)
        return "阿里妈妈";
    if (host.indexOf("finance.ifeng.com") >= 0)
        return "凤凰财经";
    if (host.indexOf("blog.sina.com.cn") >= 0)
        return "新浪博客";
    return "";
}

function getIframeSrc(from)
{
    if (from == "新浪博客")
        return "http://blog.hexun.com/inc/popbox3.aspx?fromblog=C";
    return "http://blog.hexun.com/inc/popbox1.aspx?fromblog=A";
}

function getFromStr(from)
{
    if (from != "")
        return "通过<span style='color:#900000'>" + from + "</span>";
    else
        return "";
}